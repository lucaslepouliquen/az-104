## 1.3 Role-Based Access Control (RBAC)

### RÃ´les Built-in Essentiels

**âš ï¸ Principe du Moindre PrivilÃ¨ge :** Toujours utiliser le rÃ´le avec le minimum de permissions requis

**RÃ´les Azure RBAC (Gestion des Ressources) :**

**Owner**
- **Permissions** : AccÃ¨s complet Ã  toutes les ressources
- **CapacitÃ©s** : CrÃ©ation, modification, suppression + dÃ©lÃ©gation d'accÃ¨s
- **Usage** : Administration complÃ¨te avec gestion des accÃ¨s
- **Scope** : Ressources Azure (VMs, Storage, Networks, etc.)

**Contributor**
- **Permissions** : AccÃ¨s complet aux ressources
- **Limitation** : âŒ Ne peut PAS dÃ©lÃ©guer l'accÃ¨s Ã  d'autres utilisateurs
- **Usage** : DÃ©veloppement et administration des ressources sans gestion des accÃ¨s
- **Scope** : Tous types de ressources Azure

**Reader**
- **Permissions** : Lecture seule
- **Limitation** : âŒ Aucune action de modification autorisÃ©e
- **Usage** : Monitoring, audit, consultation
- **Scope** : Visualisation des ressources existantes

**User Access Administrator**
- **Permissions** : Gestion des accÃ¨s uniquement
- **Limitation** : âŒ Ne peut PAS crÃ©er/modifier les ressources
- **Usage** : DÃ©lÃ©gation des permissions RBAC
- **Scope** : Assignations de rÃ´les uniquement

### RÃ´les Administratifs Azure AD (Gestion des IdentitÃ©s)

**User Administrator**
- **Permissions** : CrÃ©ation et gestion des utilisateurs et groupes
- **CapacitÃ©s** : Gestion des tickets de support, monitoring de la santÃ© des services
- **Usage** : Administration dÃ©diÃ©e aux utilisateurs sans privilÃ¨ges excessifs
- **Scope** : Gestion des identitÃ©s uniquement
- **âœ… RecommandÃ©** : Pour gestion quotidienne des utilisateurs

**Global Administrator**
- **Permissions** : AccÃ¨s complet Ã  toutes les fonctionnalitÃ©s Azure AD
- **CapacitÃ©s** : Plus de permissions que nÃ©cessaire pour la gestion basique
- **Usage** : Administration complÃ¨te du tenant
- **âš ï¸ Attention** : Utiliser avec parcimonie, trop de permissions pour tÃ¢ches simples

**Billing Administrator**
- **Permissions** : Gestion des aspects financiers et de facturation
- **CapacitÃ©s** : Achats, abonnements, gestion des coÃ»ts
- **Usage** : Administration financiÃ¨re
- **Scope** : Facturation et finances uniquement

**Service Administrator (Classic)**
- **Type** : RÃ´le classique (Legacy)
- **Permissions** : AccÃ¨s complet aux services Azure
- **âš ï¸ Deprecated** : RemplacÃ© par les rÃ´les RBAC modernes
- **Usage** : Non recommandÃ© pour nouvelles installations

### RÃ´les SpÃ©cialisÃ©s

**RÃ´les Ressources SpÃ©cifiques :**
- **Virtual Machine Contributor** : Gestion complÃ¨te des VMs
- **Storage Account Contributor** : Gestion des comptes de stockage
- **Network Contributor** : Gestion des ressources rÃ©seau
- **API Management Service Contributor** : Configuration et maintenance des APIs

**âš ï¸ Comparaison pour l'Examen :**

| Besoin | RÃ´le AppropriÃ© | Raison |
|--------|---------------|--------|
| GÃ©rer utilisateurs et groupes | **User Administrator** | Moindre privilÃ¨ge suffisant |
| CrÃ©er et gÃ©rer VMs | **Contributor** ou **VM Contributor** | Pas besoin de gestion d'accÃ¨s |
| Consulter les ressources | **Reader** | Lecture seule |
| GÃ©rer les permissions | **Owner** ou **User Access Administrator** | DÃ©lÃ©gation requise |
| Administration complÃ¨te tenant | **Global Administrator** | PrivilÃ¨ges maximum |

### Scopes d'assignation RBAC - DÃ©taillÃ©

**âš ï¸ Erreur Courante QCM : Niveaux d'assignation et hÃ©ritage**

**HiÃ©rarchie des Scopes (du plus large au plus prÃ©cis) :**

```
Management Group (Racine)
    â†“ (hÃ©ritage automatique vers le bas)
Subscriptions
    â†“ (hÃ©ritage automatique vers le bas)
Resource Groups
    â†“ (hÃ©ritage automatique vers le bas)
Resources (VM, Storage, VNet, etc.)
```

**âœ… Principe d'HÃ©ritage RBAC :**
- RÃ´le au **Management Group** â†’ S'applique Ã  **toutes** les subscriptions et ressources sous-jacentes
- RÃ´le Ã  la **Subscription** â†’ S'applique Ã  **tous** les Resource Groups et ressources
- RÃ´le au **Resource Group** â†’ S'applique Ã  **toutes** les ressources du groupe
- RÃ´le Ã  une **Resource** â†’ S'applique **uniquement** Ã  cette ressource

**Exemples Pratiques :**

```bash
# 1. Niveau Subscription - AccÃ¨s Ã  TOUS les Resource Groups
az role assignment create \
  --assignee user@contoso.com \
  --role "Contributor" \
  --scope "/subscriptions/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"

# 2. Niveau Resource Group - AccÃ¨s Ã  TOUTES les ressources du RG
az role assignment create \
  --assignee user@contoso.com \
  --role "Virtual Machine Contributor" \
  --resource-group "Production-RG"

# 3. Niveau Resource - AccÃ¨s SEULEMENT Ã  cette VM spÃ©cifique
az role assignment create \
  --assignee user@contoso.com \
  --role "Virtual Machine Contributor" \
  --scope "/subscriptions/xxx/resourceGroups/Production-RG/providers/Microsoft.Compute/virtualMachines/VM1"
```

**ScÃ©narios d'Examen :**

| Besoin | Scope | Justification |
|--------|-------|---------------|
| GÃ©rer toutes les VMs de l'entreprise | Management Group | AccÃ¨s multi-subscriptions |
| GÃ©rer toutes les ressources d'un environnement | Subscription | AccÃ¨s Ã  tous les RGs |
| GÃ©rer les ressources d'un projet | Resource Group | LimitÃ© au projet |
| GÃ©rer une VM critique | Resource | AccÃ¨s ultra-restreint |

**âš ï¸ Best Practice - Least Privilege :**
- âœ… TOUJOURS assigner au scope le **plus restreint** possible
- âŒ Ã‰VITER Owner/Contributor au niveau Subscription
- âœ… UTILISER des rÃ´les spÃ©cifiques (Storage Blob Data Contributor, etc.)

**Validation des assignations :**
```bash
# Lister les assignations d'un utilisateur
az role assignment list --assignee user@contoso.com --output table

# VÃ©rifier les permissions sur une ressource
az role assignment list --scope "/subscriptions/xxx/resourceGroups/myRG"
```

